---
title: Docker实战系列 — 容器
_date: 11 Apr 2015
---

### 核心的所在 ###

容器技术并不是Docker首创，很早前LXC技术就出现了，但Docker将其推向了一个新的高度。很多人，如我，就是接触Docker之后才知道容器的，请记住Container这个词。

前面的文章中运行了第一个容器，不知大家对容器是否有了一些体会，这里专门来扯扯容器这个东西。

---------

### 运行容器

运行容器的命令就是run，linux的命令总是那么直观。

`# docker run [Option] Images [Command]`

再次强调images可以用其ID前是个字符代替。关于容器的知识太多了，什么后台运行，映射端口，容器数据卷等等。太高深的不懂，但经验性的东西我还是需要说（bb）一下。

首先，来说说运行命令里最后加的那个Command，这个是可选的，建议不必选，除非你明确要运行某个程序，而没打算进入bash去管理。原因在于，命令执行完后，会退出容器，也就是状态变为Exited，当然加了rm参数的就啥也没有了。

对于选项，我还是觉得没必要去细说，书本上写的很好了，我再写一遍反而装不了逼。

然后是，容器启动后会被分配一个256byte的ID，这个ID可以用来对容器进行一些操作，比如停止，重启等。重要的是，使用docker commit可以保存此时正在使用的容器，因为里面有我们的改动，如果不保存，下次重启一个容器还是原来的状态。

`# docker commit Container\_ID new\_name`

如果此时你正在容器里还，可以用**Ctrl+p** + **Ctrl+q**暂时退出，容器依然在运行，之后用docker attach再次进入

`# docker attach Container\_ID`

--------

### 容器网络

我相信大部分人关注最多的当属容器网络这块。然而容器的网络也有很多东西，我们从最常用，最简单的说起。

####外部访问容器

这是最容易的，-P，-p两个参数看看介绍就会了，这里我想讲的是如何测试指定或者自动分配的端口能够被访问。由于，我开始用Docker就在制作了一个含有web server的镜像，所以很容易测试是否端口映射到主机成功没。但这未免麻烦，这里有个命令很好用：**nc**

也许你知道用nc来聊天，但是其用在测试端口也是不错的。自己去看nc的帮助文档，还不会的给我留言。

#### 容器访问外网

这里没多少说的，因为创建容器的时候就会在主机里建立一条转发规则，使用这个命令可以看到

`# iptables -L`

#### 容器间访问

docker是默认容器间可以访问的，如果你想禁用也可以。并且也是默认容器间开放所有端口，这给一些搞测试需要几个主机间相互访问提供了便利，由于docker的轻量级，完全可以开几个容器，然后相互间干活。

### 多说一句

关于用docker真正部署一些东西，比如web server啥的，我的经验不多，然而这很简单。但记住docker毕竟不是完全意义上的虚拟，它是建立在主机OS之上的，所有有些部署过程中错误在所难免，这时候就需要去官方手册寻求帮助，也可以发邮件给我。

PS：后面我会介绍一些部署应用程序的简单例子，我希望的是纯粹而简单的学习，复杂的让人失去兴趣。然而现在事情较多，比如考试，可能暂时不会写Blog &_&。
